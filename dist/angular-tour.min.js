!function(a){"use strict";angular.module("angular-tour",["angular-tour.tour"]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",previousLabel:"Previous",finishLabel:"Finish",scrollSpeed:500,offset:28,backdrop:!0}).controller("TourController",["$scope","orderedList",function(a,b){var c=this,d=c.steps=b();c.postTourCallback=angular.noop,c.postStepCallback=angular.noop,c.currentStep=0,c.firstStep=0,c.lastStep=0,a.$watch(function(){return c.currentStep},function(a){c.select(a)}),c.select=function(a){if(angular.isNumber(a)){c.unselectAllSteps();var b=d.get(a);b&&(b.ttOpen=!0),c.currentStep!==a&&(c.currentStep=a),a>c.lastStep&&c.postTourCallback(),c.postStepCallback()}},c.addStep=function(a){angular.isNumber(a.index)&&!isNaN(a.index)?(a.index>c.lastStep&&(c.lastStep=a.index),(0===c.firstStep||a.index<c.firstStep)&&(c.firstStep=a.index),d.set(a.index,a)):(c.lastStep=d.getCount(),d.push(a))},c.unselectAllSteps=function(){d.forEach(function(a){a.ttOpen=!1})},c.isFirstStep=function(){return c.currentStep===c.firstStep},c.isLastStep=function(){return c.currentStep===c.lastStep},c.cancelTour=function(){c.unselectAllSteps(),c.postTourCallback()},a.openTour=function(){var a=c.currentStep>=d.getCount()||c.currentStep<0?0:c.currentStep;c.select(a)},a.closeTour=function(){c.cancelTour()}}]).directive("tour",["$parse","tourConfig",function(a,b){return{controller:"TourController",restrict:"EA",scope:!0,link:function(c,d,e,f){if(!angular.isDefined(e.step))throw"The <tour> directive requires a `step` attribute to bind the current step to.";var g=a(e.step),h=!1,i=angular.element('<div class="tourtip-backdrop"></div>'),j=angular.element('<div class="tourtip-highlight-helper"></div>');c.$watch(e.step,function(a){f.currentStep=a,!h&&b.backdrop&&a>0&&(i.css({top:0,bottom:0,left:0,right:0,position:"fixed",opacity:.8,"background-color":"#000","z-index":"1000",transition:"all .5s ease-out"}),angular.element("body").append(i),angular.element("body").append(j),h=!0)}),f.postTourCallback=function(){h&&b.backdrop&&(i.remove(),j.remove()),angular.isDefined(e.postTour)&&c.$parent.$eval(e.postTour)},f.postStepCallback=function(){angular.isDefined(e.postStep)&&c.$parent.$eval(e.postStep)},c.setCurrentStep=function(a){g.assign(c.$parent,a),f.currentStep=a},c.getCurrentStep=function(){return f.currentStep},c.isFirstStep=function(){return f.isFirstStep()},c.isLastStep=function(){return f.isLastStep()}}}}]).directive("tourtip",["$window","$compile","$interpolate","$timeout","scrollTo","tourConfig",function(b,c,d,e,f,g){var h=(d.startSymbol(),d.endSymbol(),"<div tour-popup></div>");return{require:"^tour",restrict:"EA",scope:!0,link:function(d,i,j,k){function l(){var c,e,h,i,j,k;if(d.ttContent){d.ttAnimation?o.fadeIn():o.css({display:"block"}),angular.element("body").append(p),angular.element("body").append(o);var l=function(){c=n[0].getBoundingClientRect(),e=o[0].offsetWidth,h=o[0].offsetHeight,k=n.width(),j=n.height(),n.css({"z-index":1002,position:"relative",transition:"all .05s linear .295s"});var b=c.top+a.pageYOffset,l={};l.position="absolute",l.top=b,l.left=c.left,l.width=n[0].offsetWidth,l.height=n[0].offsetHeight;var m=angular.copy(l);m.background="transparent",m["z-index"]=1003,l["z-index"]=1001,l["background-color"]="rgba(255,255,255,.8)",l["box-shadow"]="0 2px 15px rgba(0,0,0,.4)",l.transition="all .3s ease-in",angular.element(".tourtip-highlight-helper").css(l),p.css(m);var q=parseInt(o.find(".tail").css("top"),0);switch(d.ttPlacement){case"right":i={top:b-q-j/2,left:c.left+k+d.ttOffset};break;case"bottom":i={top:b+j+d.ttOffset,left:c.left};break;case"left":i={top:b-q-j/2,left:c.left-e-d.ttOffset};break;default:i={top:b-h-d.ttOffset,left:c.left}}i.top+="px",i.left+="px",o.css(i),f(o,-200,-300,g.scrollSpeed)};angular.element(b).bind("resize."+d.$id,function(){l()}),l()}}function m(){o.detach(),n.css({"z-index":"","position:":"",transition:""}),angular.element(b).unbind("resize."+d.$id)}var n;j.$observe("tourtip",function(a){d.ttContent=a}),j.$observe("tourtipTitle",function(a){d.ttTitle=a}),j.$observe("tourtipPlacement",function(a){d.ttPlacement=a||g.placement}),j.$observe("tourtipNextLabel",function(a){d.ttNextLabel=a||g.nextLabel}),j.$observe("tourtipPreviousLabel",function(a){d.ttPreviousLabel=a||g.previousLabel}),j.$observe("tourtipLastLabel",function(a){d.ttFinishLabel=a||g.finishLabel}),j.$observe("tourtipOffset",function(a){d.ttOffset=parseInt(a,10)||g.offset}),d.ttOpen=!1,d.ttAnimation=g.animation,d.index=parseInt(j.tourtipStep,10);var o=c(h)(d),p=angular.element('<div class="tourtip-highlight-blockr"></div>');n=i,k.addStep(d),e(function(){d.$watch("ttOpen",function(a){a?l():m()})},500),d.$on("$destroy",function(){angular.element(b).unbind("resize."+d.$id),o.remove(),p.remove(),o=null})}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"tour/tour.tpl.html",scope:!0,restrict:"EA",link:function(){}}}).factory("orderedList",function(){var a=function(){this.map={},this._array=[]};a.prototype.set=function(a,b){if(angular.isNumber(a))if(a in this.map)this.map[a]=b;else{if(a<this._array.length){var c=a-1>0?a-1:0;this._array.splice(c,0,a)}else this._array.push(a);this.map[a]=b,this._array.sort(function(a,b){return a-b})}},a.prototype.indexOf=function(a){for(var b in this.map)if(this.map.hasOwnProperty(b)&&this.map[b]===a)return Number(b)},a.prototype.push=function(a){var b=this._array[this._array.length-1]+1||0;this._array.push(b),this.map[b]=a,this._array.sort(function(a,b){return a-b})},a.prototype.remove=function(a){var b=this._array.indexOf(a);if(-1===b)throw new Error("key does not exist");this._array.splice(b,1),delete this.map[a]},a.prototype.get=function(a){return this.map[a]},a.prototype.getCount=function(){return this._array.length},a.prototype.forEach=function(a){for(var b,c,d=0;d<this._array.length;d++)b=this._array[d],c=this.map[b],a(c,b)},a.prototype.first=function(){var a,b;return a=this._array[0],b=this.map[a]};var b=function(){return new a};return b}).factory("scrollTo",function(){return function(a,b,c,d){a?(b=b||-100,c=c||-100,d=d||500,$("html,body").stop().animate({scrollTop:a.offset().top+b,scrollLeft:a.offset().left+c},d)):$("html,body").stop().animate({scrollTop:0},d)}})}(window,document);